---
import BaseHead from "../components/BaseHead.astro";
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro'

export interface Props {
    title?: string,
    description?: string
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="zh-CN" data-overlayscrollbars-initialize>
    <head>
        <BaseHead title={title} description={description} />
    </head>

    <body  class="flex flex-col" data-overlayscrollbars-initialize>
        <!-- <Header client:only="vue"/> -->
        <Header/>
        <main class="flex-1">
            <div class="container px-4 mx-auto flex-1 h-full">
                <slot />
            </div>
        </main>
        <Footer />

        <div class="fixed right-4 bottom-4 md:right-8 md:bottom-8">
            <button id="back-to-top hidden" class="shadow-md rounded-lg bg-gray-100 p-1.5">
                <i class="iconify mdi--arrow-up-bold text-3xl text-gray-500 block"></i>
            </button>
        </div>
    </body>
</html>

<script>
import 'overlayscrollbars/overlayscrollbars.css';
import { OverlayScrollbars } from 'overlayscrollbars';

function initCustomScrollbar() {
    OverlayScrollbars(
        {
            target: document.querySelector('body')!,
            cancel: {
                nativeScrollbarsOverlaid: true
            }
        }, {
            scrollbars: {
			    autoHide: 'move',
			    autoHideDelay: 500,
			    autoHideSuspend: false
            }
        }
    );

    document.querySelectorAll('pre').forEach(ele => {
        OverlayScrollbars(ele, {
			scrollbars: {
				autoHide: 'leave',
				autoHideDelay: 500,
				autoHideSuspend: false
			}
		});
    })
}


function loadButtonScript() {
    // 初始化滚动按钮
    var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
    if (scrollTop > 200) {
        document.getElementById('back-to-top')?.parentElement?.classList.remove('hidden')
    } else {
        document.getElementById('back-to-top')?.parentElement?.classList.add('hidden')
    }

    window.addEventListener('scroll', () => {
        var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        if (scrollTop > 200) {
            document.getElementById('back-to-top')?.parentElement?.classList.remove('hidden')
        } else {
            document.getElementById('back-to-top')?.parentElement?.classList.add('hidden')
        }
    })
    document.getElementById('back-to-top')?.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' })
    })
}

function init() {
    initCustomScrollbar()
    loadButtonScript()
}

init()

document.addEventListener('astro:after-swap', init);

</script>